---
layout: post
title: "图形程序设计续之零碎问题"
categories: []
tags: []
status: publish
type: post
published: true
meta:
  blogger_blog: missdeer.blogspot.com
  blogger_author: missdeerhttp://www.blogger.com/profile/18003139432457999590noreply@blogger.com
  blogger_permalink: "/2009/08/blog-post_28.html"
author: 
---
<p>　　图形编辑功能已经做了两周了，到现在为止，也只能画出矩形框，在矩形框之间用白线、样本曲线，或贝塞尔曲线进行连接。又一次发现，只有在编码实现的时候，才会遇到很多之前没有想到的各种问题，而且有些问题要解决，也是要花费不少功夫的。<br />　　要考虑图层的问题，如何定义每个图形所在的图层，在绘制时，才得比较方便快速，而且需要可以随时修改图形所在的图层。图层的影响是多方面的，例如在绘制整张画布及图形对象时，要从底层开始绘制，而对于在某个点上点击选中一个图形对象时，却要从上到下进行遍历查找。<br />　　还考虑随时可以修改画布的大小，因为在添加图形，或修改图形位置时，是随时都可能把图形放在一个走出当前画布大小的位置上的，这时程序应该可以自动检测出需要扩大多少。对于向右、向下方向的扩大处理很方便，直接将画布大小重新定义即可。而对于向左、向上方向的扩展，则除了重新定义画布大小外，还得把超出部分归整到（0，0）这个坐标上，也就是说，要把所有已存在的图形对象的位置都调整一遍。<br />　　再要考虑子图的问题。也就是说，一张完整的图片，在某一时刻，只是显示了其中一部分图形对象，这部分当前被显示的可以作为一个子图来对象，而没有被显示，则是属于其他的子图。每个子图之间应该没有多少强相关的关系，最多是一个图形，与一个子图可以有包含（从属）关系，一个子图用来解释一个图形。常见的一种应用场景就是，双击了某个图形，就展示另外一张图片。这就同样要求设计一种灵活高效的数据结构来保存这些信息。<br />　　从当前的实现情况看，每个图形对象中，都有不少成员变量，保存了一些中间数据，这些中间数据不属于图形对象的本质属性，却对于图形在特定时刻进行动作起着重要作用，从代码美观角度讲，感觉很冗余，所以要考虑如何优化，减少这种成员变量。例如对于一些状态变量，或许可以用位域的标识。</p>
