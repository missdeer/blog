---
layout: post
title: "图形程序设计续之困扰"
categories:
- Software
---
<p>　　开始做那个图形编辑程序1周多了，现在遇到了瓶颈，因为原来的设计考虑得太不全面，很多很明显的问题都没有有顾及到，结果到实际编码实现到一定程度时，发现原来的程序结构有点不行了，不够用了。<br />　　主要的矛盾在于，原本我的设计上是，每种图形，都各自响应用户操作，互相不知道其他同类的存在。而实际上这是不对的，或者说不合适的，比如连接线，在端点确定前就是要知道那个位置是否贴到某个图形上了。另一方面，当某个图形上的连接点移动时，同样得通知所有跟这连接点连着的连接线，或者是某个图形被删除时，得同时删除连接在它上面的所有连接线。<br />　　本来所有图形对象都在一个管理器进行任务分派，现在看来，至少有得有一个类，可能还是这个图形对象管理器，做更多的事情，可以查询它所管理的图形对象一些特殊的状态，还要维护图形对象间的关系，可以是一个邻接矩阵，或一个邻接链表，反正就是一个图的表示法。这些不是我现在的主要困扰，我的困扰在于，图形对象怎么来调用这些查询状态的操作。本来图形对象被那个管理器对象包含了，另一方面那些查询状态的操作得知道所有这些对象，这样的循环依赖，让我感觉不爽！</p>
