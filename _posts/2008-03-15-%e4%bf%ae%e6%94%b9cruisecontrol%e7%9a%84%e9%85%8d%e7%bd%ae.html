---
layout: post
title: "修改CruiseControl的配置"
categories:
- CPPOOPGPXP
tags: []
status: publish
type: post
published: true
meta:
  blogger_blog: missdeer.blogspot.com
  blogger_author: missdeerhttp://www.blogger.com/profile/18003139432457999590noreply@blogger.com
  blogger_permalink: "/2008/03/cruisecontrol.html"
author:
  login: missdeer
  email: missdeerme@163.com
  display_name: missdeer
  first_name: "樊"
  last_name: "杨"
---
<p>　　在家无聊，看到CruiseControl里的东西就想整一下，一直以来只是抄袭了同事的脚本在这里跑，只能手动地去点击一下按钮才能激发，想着就不舒服。从网上搜了点资料看看，实在是找不到有用的，于是再回来看自带的帮助和自带的例子，偶然发现，虽然命令行中老是输出一堆一堆的内容，其实对于出错的情况还是解释得比较清楚的，尽管不详细。仔细调试配置脚本，终于可以定时轮循VSS中的文件并做出相应的响应了。其实非常简单，只是以前一直没有静下心来搞而已：<br />
<style type="text/css">.S0 {<br /> font-family: 'Times New Roman';<br /> color: #000000;<br /> font-size: 11pt;<br />}<br />.S1 {<br /> color: #000080;<br />}<br />.S3 {<br /> color: #008080;<br />}<br />.S6 {<br /> color: #7F007F;<br />}<br />.S8 {<br /> color: #800080;<br />}<br />.S11 {<br /> color: #000080;<br />}<br />span {<br /> font-family: 'Verdana';<br /> color: #000000;<br /> font-size: 10pt;<br />}<br /></style>
<p><span><span class="S1">&lt;listeners&gt;</span><br /><span class="S0">&nbsp; &nbsp; </span><span class="S1">&lt;currentbuildstatuslistener</span><span class="S8"> </span><span class="S3">file</span><span class="S8">=</span><span class="S6">"${ccworkspace}/logs/${project.name}/status.txt"</span><span class="S11">/&gt;</span><br /><span class="S1">&lt;/listeners&gt;</span><br /><span class="S1">&lt;bootstrappers&gt;</span><br /><span class="S0">&nbsp; &nbsp; </span><span class="S1">&lt;vssbootstrapper</span><span class="S8"> </span><span class="S3">vsspath</span><span class="S8">=</span><span class="S6">"${vsspath}"</span><span class="S8"> </span><span class="S3">ssdir</span><span class="S8">=</span><span class="S6">"${ssdir}"</span><span class="S8"> </span><span class="S3">login</span><span class="S8">=</span><span class="S6">"${username},${password}"</span><span class="S8"> </span><span class="S3">serverpath</span><span class="S8">=</span><span class="S6">"${serverpath}"</span><span class="S8"> </span><span class="S3">localdirectory</span><span class="S8">=</span><span class="S6">"${ccworkspace}/projects/${project.name}"</span><span class="S11">/&gt;</span><br /><span class="S1">&lt;/bootstrappers&gt;</span><br /><span class="S1">&lt;modificationset</span><span class="S8"> </span><span class="S3">quietperiod</span><span class="S8">=</span><span class="S6">"30"</span><span class="S1">&gt;</span><br /><span class="S0">&nbsp; &nbsp; </span><span class="S1">&lt;vss</span><span class="S8"> </span><span class="S3">ssdir</span><span class="S8">=</span><span class="S6">"${ssdir}"</span><span class="S8"> </span><span class="S3">login</span><span class="S8">=</span><span class="S6">"${username},${password}"</span><span class="S8"> </span><span class="S3">vsspath</span><span class="S8">=</span><span class="S6">"${vsspath}"</span><span class="S8"> </span><span class="S3">serverpath</span><span class="S8">=</span><span class="S6">"${serverpath}"</span><span class="S8"> </span><span class="S3">dateformat</span><span class="S8">=</span><span class="S6">"yy-MM-dd"</span><span class="S8"> </span><span class="S3">timeformat</span><span class="S8">=</span><span class="S6">"HH:mm"</span><span class="S11">/&gt;</span><br /><span class="S1">&lt;/modificationset&gt;</span><br /><span class="S1">&lt;schedule</span><span class="S8"> </span><span class="S3">interval</span><span class="S8">=</span><span class="S6">"600"</span><span class="S1">&gt;</span><br /><span class="S0">&nbsp; &nbsp; </span><span class="S1">&lt;ant</span><span class="S8"> </span><span class="S3">antscript</span><span class="S8">=</span><span class="S6">"${antpath}"</span><span class="S8"> </span><span class="S3">antworkingdir</span><span class="S8">=</span><span class="S6">"${ccworkspace}"</span><span class="S8"> </span><span class="S3">buildfile</span><span class="S8">=</span><span class="S6">"build.xml"</span><span class="S8"> </span><span class="S3">target</span><span class="S8">=</span><span class="S6">"wallpaperhelper_All"</span><span class="S11">/&gt;</span><br /><span class="S1">&lt;/schedule&gt;</span></span><br />各节属性的作用都可以查看CC帮助了解，只要把该填的都填好，就基本上没什么问题了。用VSS跟用SVN或CVS还是有一点区别的，网上很难找到用VSS的例子，好在也确实不复杂，呵呵。<br />　　解决了这个问题后，我就开始得寸进尺期望CC能在后台运行。CC自带的解决方案是用一个叫Jetty的应用程序服务器，然后通过JAVA来运行。从这里可以看出，应该是能用Tomcat之类的其它的应用程序服务器来运行CC的，而Tomcat又能跟Apache配接在一起用，所以我觉得大概这是最好的方案，不过就是对于几人几十人的小项目来说，似乎有点杀鸡用牛刀了。其实再看一下那个启动CC用的bat文件就能发现，只要预先设置好几个环境变量，然后就能在后台用JAVAW.EXE来启动CC了。这里还有一个问题是，CC启动时，会在当前目录下寻找config.xml文件，所以一定要把config.xml文件放在它找得到的地方，我的办法是给这个命令行建立一个快捷方式，然后把开始位置设到config.xml所在的目录下，把这个快捷方式放到开始菜单的启动文件夹中，就可以让CC随着系统而在后台一起启动了。但是，后台运行也有一个不好的地方，不能随时看到CC最新的运行状态，通过浏览器的信息总感觉有些许延迟。</p>
