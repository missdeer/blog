---
layout: post
title: exchndl.dll提取出来了
categories:
- Shareware
---
<p>　　昨天好不容易咬咬牙，把捕获未处理异常的功能提取出来封装成一个dll了。这是一个很简单的功能，所有的代码都是现成的，我只不过是把它从源代码复用的方式改成了二进制复用。当时公司里的同事说我这源代码复用的方式太落后，想叫我改成一个COM组件。而我又恰恰对COM很反感，所以一直都没动手。这次在一体化平台中涉及到2个exe程序，而只在一个主程序中用到了这个功能，有一天收到一个报告，另一个exe程序也会崩溃了，所以就有了要分离出来的想法。<br />　　提取成dll我当然不会用COM来封装，而是学MinGW中的exchndl.dll的方式，移植的主要工作是把MFC中的CString类都替换掉。这花了不多的时间，然后放在WallpaperHelper中进行测试。<br />　　除了记录了系统简要信息和调用栈信息，我还另外加了几项也许有点用的内容，包括当前系统中所有的进程、环境变量、当前进程所有的模块、所有线程信息。本来还想加些其他内容的，比如当前系统的服务信息、系统设备驱动程序信息、当前进程的所有句柄、所有文件映射、所有窗口等等，不过想到暂时这些信息也不是很重要，而且这样会让生成崩溃报告的时间更长，先还是放一边吧。<br />　　最近我想我真的是工作压力大了点，昨天下午睡午觉，梦到了很多乱七八糟的事情。最让我觉得气愤的是，居然梦到有个老女人，对我的工作指手划脚的，然后旁边两个同事也不知道在干吗，跟现实中的很相似。真是日有所思，夜有所梦，愤慨啊，竟然我的梦都被人这样强加干涉了！</p>
