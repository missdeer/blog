---
layout: post
title: "关于打谱程序突然想到的"
categories:
- Shareware
---
<p>　　今天突然有个想法，关于前段时间的用WTL写个围棋打谱程序的念头，是否可以把棋盘、棋子绘画动作也抽象出来，棋子的位置、走法规则都提取出来，有一组严谨的约束，而且这组约束可以通过配置文件，或者脚本来描述，最后，C/C++代码则只用来完成具体的绘画操作，对这些约束完全一无所知，比如它只知道在哪个坐标画一个什么样的图形，而为什么要画这个图形，这个图形有什么其他的含义，都不是它需要知道的。<br />　　如果确实能高度抽象地完成这个描述，那么带来的灵活性则是非常有用的。对于单纯是一个围棋打谱程序来说，也许带来的好处并不明显。但再换个角度考虑，在这一套架构下，很容易通过写少量脚本或配置文件，而不需要修改一行C++代码，一个围棋打谱程序立马摇身一变，成了一个象棋打谱程序，或者五子棋打谱程序了。这样的诱惑，对目前的我来说，实在是巨大呀！<br />　　这个想法的灵感，源于Eclipse的编辑器，《Contributing to Eclipse》中有一小段描述可以贡献一个编辑器，当时看到这段描述，甚是激动，差点想把那个IDE项目中的编辑器模块也这样做了。这次又联想到打谱程序，同样是画棋盘棋子的，只要合理设计，理应也可以达到类似的效果。<br />　　不过随便想想，以在世界范围最流行的4种棋类（围棋、中国象棋、国际象棋、五子棋）为目标，要想尽可能简单且灵活地实现，还有点困难。如何表示棋子的类型、如何表示行棋规则、如何定义精确的棋子位置以便程序绘制等等，都是摆在眼前最大的障碍。五子棋最容易表示，只有2种棋子，直接落子，虽也有像五手两打，三手交换之类的奇怪规则，但这些似乎都是在棋谱解析部分的工作。围棋则略为复杂，一个明显的问题是，要能计算出死子，并提出棋盘，这个工作如果纯粹交给外部脚本做，怕是会有心无力，但照现在的设计思想又不能让C/C++代码来做。两种象棋就更复杂了，棋子的类型就相比多了很多，每种棋子的合理行棋方式又都不一样，虽然从纯粹打谱的角度讲，比围棋、五子棋也复杂不了多少，但是在棋谱录入时，则很让我头痛了，如何表示一个棋子从一个位置移动到另一个位置，是否可以移动，移动后是否棋子的属性有变化（中国象棋中兵过河可横行，国际象棋中兵到底线可变身），移动后是否影响了其他棋子（吃掉了）等等，关键是一套界面和逻辑的交互协议，不能设计得太偏向于是为某种任务而特意为之，但又得有足够的信息在两者之间传递！</p>
